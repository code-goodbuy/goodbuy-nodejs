{
  "summary": {
    "title": "Threat model for prod backend",
    "owner": "Anthony"
  },
  "detail": {
    "contributors": [
      {
        "name": "Dave"
      },
      {
        "name": "Darjusch"
      },
      {
        "name": "Jongwoo"
      }
    ],
    "diagrams": [
      {
        "title": "GoodBuy Diagram",
        "thumbnail": "./public/content/images/thumbnail.jpg",
        "id": 0,
        "diagramJson": {
          "cells": [
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 641,
                "y": 275
              },
              "angle": 0,
              "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb",
              "z": 1,
              "hasOpenThreats": false,
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Repudiation",
                  "title": "Logging activities of hacker",
                  "description": "Logging all activities to report on hackers attack",
                  "mitigation": "Solved:\nLoggin implemented with AWS Cloud Watch\n\nLogging to an external data source, with restricted access"
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "title": "DDoS Attack",
                  "description": "Distributed Denial-of-Service attack to freeze server",
                  "mitigation": "AWS includes DDoS protection by default"
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "title": "File structure exposure",
                  "description": "Exposing the file structure to get access to crucial information about the infrastructure.",
                  "mitigation": "Solved:\n- We don't serve anything else than the API\n\n\nSetting permissions, and defining public folders"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Node.js - REST\nAPI"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 279,
                "y": 287
              },
              "angle": 0,
              "id": "2aaa949d-b1e3-4447-894d-624189e0da52",
              "z": 2,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Next.js app"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 674,
                "y": 12
              },
              "angle": 0,
              "id": "b26b66af-ffac-4bdf-9fb9-b86a54a4ee91",
              "z": 3,
              "hasOpenThreats": false,
              "storesCredentials": true,
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Unauthorized access",
                  "type": "Information disclosure",
                  "description": "An unauthorized query could be made to the DB.",
                  "mitigation": "Solved:\n- We implemented users which only have role-based access\n\nAuthenticate all queries."
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Credential theft",
                  "type": "Information disclosure",
                  "description": "Access to the DB credentials and makes unauthorised queries.",
                  "mitigation": "Solved:\n- Restricted IPs\n\nIP restriction (via firewall or other)"
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Credentials encryption",
                  "type": "Information disclosure",
                  "description": "Solved:\n- Passwords are hashed and salted\n\nCredentials should be encrypted, with salt.",
                  "mitigation": "Credentials should be encrypted, with a salt."
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "MongoDB"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 60,
                "y": 485
              },
              "angle": 0,
              "id": "9e5cb7d7-4afd-4b32-9961-9cba06ba1504",
              "z": 4,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Browser"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "9e5cb7d7-4afd-4b32-9961-9cba06ba1504"
              },
              "target": {
                "id": "2aaa949d-b1e3-4447-894d-624189e0da52"
              },
              "vertices": [],
              "id": "3da70779-7365-4999-b5b2-af7d73b8dc56",
              "labels": [
                {
                  "position": {
                    "distance": 0.5378342713991623,
                    "offset": -0.14673516575599738
                  },
                  "attrs": {
                    "text": {
                      "text": "Web request",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 5,
              "hasOpenThreats": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTP/S",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "HTTP/S",
                  "type": "Information disclosure",
                  "description": "Traffic is going over the open internet and could be subject to interception.",
                  "mitigation": "Solved:\n- Nginx reverse proxy implemented which handles the HTTPS through certificate\n\n\nHTTP/S should be provided for security and confidentiality. No HTTP allowed."
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "NoSQL Injection",
                  "type": "Information disclosure",
                  "description": "NoSQL Injection to send an unauthorized query and get private information.",
                  "mitigation": "Solved:\n- Input validation in the backend\n\nValidation in the Node.js backend (middleware) (?) - to check\nValidation in the front end?"
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Cross-Site Scripting",
                  "type": "Spoofing",
                  "description": "Getting the session cookie for unauthorized access",
                  "mitigation": "Solved:\n- Added HTTP only cookie\n- Input validation \n- Proxy in Frontend\n\ncookie security \nInput validation\nEscaping string input"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "2aaa949d-b1e3-4447-894d-624189e0da52"
              },
              "target": {
                "id": "b07d80f4-2283-44a1-b135-72b60aa5e297"
              },
              "vertices": [],
              "id": "79173567-a1ee-445b-8567-ea7f9983e735",
              "labels": [
                {
                  "position": {
                    "distance": 0.5604395452609449,
                    "offset": -6.140922593031788
                  },
                  "attrs": {
                    "text": {
                      "text": "Web Req",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 7,
              "hasOpenThreats": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "HTTP/S",
                  "type": "Information disclosure",
                  "mitigation": "Solved:\n- Nginx with certificate"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 917,
                "y": 603
              },
              "angle": 0,
              "id": "2d2def3c-a2b1-4f12-b0b0-514abcf0cfaa",
              "z": 8,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Scrapers"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "b07d80f4-2283-44a1-b135-72b60aa5e297"
              },
              "target": {
                "id": "2aaa949d-b1e3-4447-894d-624189e0da52"
              },
              "vertices": [
                {
                  "x": 435,
                  "y": 372
                }
              ],
              "id": "3a462bc2-3b5a-49f4-a3bf-f7f438290952",
              "labels": [
                {
                  "position": {
                    "distance": 0.5512554115197155,
                    "offset": -10.659327236714828
                  },
                  "attrs": {
                    "text": {
                      "text": "Web App query\nresults",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 9,
              "hasOpenThreats": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 656,
                "y": 594
              },
              "angle": 0,
              "id": "0b956087-3024-4f46-acfb-cff1bf67daed",
              "z": 10,
              "hasOpenThreats": false,
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "title": "Restricted to Backend, Nginx or VPN",
                  "description": "The RabbitMQ Services is only receiving messages from Backend or through VPN (for testing reasons), the manager UI is only available through Nginx or through VPN."
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Rabbit MQ"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "target": {
                "id": "0b956087-3024-4f46-acfb-cff1bf67daed"
              },
              "vertices": [
                {
                  "x": 690,
                  "y": 423
                },
                {
                  "x": 674,
                  "y": 523
                }
              ],
              "id": "4edae733-4a9d-4510-b213-dd9ed1be3038",
              "labels": [
                {
                  "position": {
                    "distance": 0.5692881885997947,
                    "offset": -13.187223152750814
                  },
                  "attrs": {
                    "text": {
                      "text": "AMQP Prot.",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 11,
              "hasOpenThreats": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0b956087-3024-4f46-acfb-cff1bf67daed"
              },
              "target": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "vertices": [
                {
                  "x": 744,
                  "y": 461
                }
              ],
              "id": "9d56ab96-6e87-405d-afb2-2757021659dc",
              "labels": [
                {
                  "position": {
                    "distance": 0.6178102412116017,
                    "offset": 7.288703176173615
                  },
                  "attrs": {
                    "text": {
                      "text": "AMQP Prot.",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 12,
              "hasOpenThreats": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0b956087-3024-4f46-acfb-cff1bf67daed"
              },
              "target": {
                "id": "2d2def3c-a2b1-4f12-b0b0-514abcf0cfaa"
              },
              "vertices": [],
              "id": "804da8b1-65c4-4dff-892e-89fb9abc1609",
              "labels": [
                {
                  "position": {
                    "distance": 0.5,
                    "offset": 8.245426943524661
                  },
                  "attrs": {
                    "text": {
                      "text": "AMQP Prot.",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 13,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "target": {
                "id": "b26b66af-ffac-4bdf-9fb9-b86a54a4ee91"
              },
              "vertices": [
                {
                  "x": 695,
                  "y": 139
                }
              ],
              "id": "a362c96c-9dd2-401d-b5a6-c3870fc8f125",
              "labels": [
                {
                  "position": {
                    "distance": 0.7588251603875771,
                    "offset": 8.537325039028977
                  },
                  "attrs": {
                    "text": {
                      "text": "Product queries",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 15,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "b26b66af-ffac-4bdf-9fb9-b86a54a4ee91"
              },
              "target": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "vertices": [
                {
                  "x": 798,
                  "y": 144
                }
              ],
              "id": "c42d3a50-f9d7-45ef-aab4-65388a467171",
              "labels": [
                {
                  "position": {
                    "distance": 0.2750740937815443,
                    "offset": -13.323694199379776
                  },
                  "attrs": {
                    "text": {
                      "text": "Product queries\nresult",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 16,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Low",
                  "title": "Man in the Middle attack",
                  "type": "Information disclosure",
                  "description": "Attacker could get access to sensitive data (real names, adresses...)",
                  "mitigation": "Encryption of the connection."
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 592,
                "y": 119
              },
              "target": {
                "x": 872,
                "y": 125
              },
              "vertices": [
                {
                  "x": 655,
                  "y": 156
                },
                {
                  "x": 756,
                  "y": 177
                },
                {
                  "x": 846,
                  "y": 166
                }
              ],
              "id": "9d8f047d-447d-4681-93dd-abca955761a7",
              "z": 17,
              "attrs": {}
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "2d2def3c-a2b1-4f12-b0b0-514abcf0cfaa"
              },
              "target": {
                "id": "0b956087-3024-4f46-acfb-cff1bf67daed"
              },
              "vertices": [
                {
                  "x": 848,
                  "y": 609
                }
              ],
              "id": "77c9357c-6455-416d-a4af-8e62ab55187f",
              "labels": [
                {
                  "position": {
                    "distance": 0.5292273258977648,
                    "offset": 1.6827699522241306
                  },
                  "attrs": {
                    "text": {
                      "text": "AMQP Prot.",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 25,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "2d2def3c-a2b1-4f12-b0b0-514abcf0cfaa"
              },
              "target": {
                "id": "b26b66af-ffac-4bdf-9fb9-b86a54a4ee91"
              },
              "vertices": [
                {
                  "x": 1012,
                  "y": 368
                },
                {
                  "x": 937,
                  "y": 173
                }
              ],
              "id": "0c965b87-bdc1-4a7c-b9d2-753e942bbc8f",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Query",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 26,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "2aaa949d-b1e3-4447-894d-624189e0da52"
              },
              "target": {
                "id": "9e5cb7d7-4afd-4b32-9961-9cba06ba1504"
              },
              "vertices": [
                {
                  "x": 214,
                  "y": 379
                }
              ],
              "id": "e57bca7a-6032-4225-8059-33db4c725fd5",
              "labels": [
                {
                  "position": {
                    "distance": 0.5084262865979731,
                    "offset": 0.5165895854261497
                  },
                  "attrs": {
                    "text": {
                      "text": "Web response",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 27,
              "hasOpenThreats": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 412,
                "y": 485
              },
              "angle": 0,
              "id": "b07d80f4-2283-44a1-b135-72b60aa5e297",
              "z": 28,
              "hasOpenThreats": true,
              "outOfScope": false,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Showing Fallback Page",
                  "type": "Information disclosure",
                  "description": "Since we still have the initial Nginx page active, externals could get that information",
                  "mitigation": "Replace it with a basic page that welcomes the visitor to our API."
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Stop using root!",
                  "type": "Elevation of privilege",
                  "description": "In order to configure and set up the infrastructure, we used the root user. We need to create a user which does the configuration and also starts the process.",
                  "mitigation": "- User with limited rights is created and in use."
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "Nginx"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "b07d80f4-2283-44a1-b135-72b60aa5e297"
              },
              "target": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "vertices": [],
              "id": "403d2331-85c4-4bb7-9bb2-bfa504a114d8",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Web req.",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 29,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "target": {
                "id": "b07d80f4-2283-44a1-b135-72b60aa5e297"
              },
              "vertices": [
                {
                  "x": 565,
                  "y": 374
                }
              ],
              "id": "f9e4c57d-1549-498e-89d5-cff29ffb6afe",
              "labels": [
                {
                  "position": {
                    "distance": 0.43927754630774934,
                    "offset": -0.7005092205813993
                  },
                  "attrs": {
                    "text": {
                      "text": "Web resp.",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 30,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 492,
                "y": 613
              },
              "angle": 0,
              "id": "c33102ca-15b1-4df1-baa1-127f8a811c95",
              "z": 31,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "title": "Altering or Deleting Logs",
                  "description": "An attacker could try to clean up behind himself by altering or deleting the logs.",
                  "mitigation": "Create a user with limited rights, so the user can't change or delete the logs, only can start the service."
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "title": "Dashboard",
                  "description": "The dashboard should be only accessible through Nginx or for the time of development through VPN.",
                  "mitigation": "Restrict the inbound IP to Nginx (and VPN)"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "Grafana /\nPrometheus"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "b07d80f4-2283-44a1-b135-72b60aa5e297"
              },
              "target": {
                "id": "c33102ca-15b1-4df1-baa1-127f8a811c95"
              },
              "vertices": [],
              "id": "15fc8cba-fa09-4856-8120-47ddd6a7ca89",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "GET / Metrics",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 32,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0b956087-3024-4f46-acfb-cff1bf67daed"
              },
              "target": {
                "id": "c33102ca-15b1-4df1-baa1-127f8a811c95"
              },
              "vertices": [],
              "id": "29f1d152-2376-48d6-a687-198bd88f4db5",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "GET / Metrics",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 33,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "target": {
                "id": "c33102ca-15b1-4df1-baa1-127f8a811c95"
              },
              "vertices": [],
              "id": "073bb579-aa69-4a2e-81fc-4bed4ee04bb1",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "GET / Metrics",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 34,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "title": "Restrict access to Grafan / Prometeus Instance",
                  "description": "All instances that are getting scraped by Grafana should only allow Grafanas IP address to do so."
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 810,
                "y": 467
              },
              "angle": 0,
              "id": "486cf73d-4b12-4431-905b-82d0aa5505f0",
              "z": 35,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "title": "Restrict to Backend",
                  "description": "The S3 bucket should only communicate to the backend.",
                  "mitigation": "Restrict the IP in- and out-bound to the backend."
                },
                {
                  "status": "Open",
                  "severity": "Low",
                  "type": "Tampering",
                  "title": "Uploading fake database",
                  "mitigation": "Having a hash to identify our own database archive zip",
                  "description": "If an attacker replaces our zip with an empty one or worse, we could lose our database on a rollback."
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Loggin actions Database",
                  "type": "Repudiation",
                  "description": "Tracking what a user does with the database.",
                  "mitigation": "Keeping a log of all operations."
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "S3 Bucket"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "486cf73d-4b12-4431-905b-82d0aa5505f0"
              },
              "target": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "vertices": [],
              "id": "b04dd3ab-34e8-49a8-a025-914940999e54",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Downstream",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 36,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "c087d323-1a3e-44cc-8680-a06b6286e8cb"
              },
              "target": {
                "id": "486cf73d-4b12-4431-905b-82d0aa5505f0"
              },
              "vertices": [
                {
                  "x": 852,
                  "y": 398
                }
              ],
              "id": "1aa28c9f-5f0b-41c9-889e-2c15b996bc05",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Upstream",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 37,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 945,
                "y": 244
              },
              "target": {
                "x": 901,
                "y": 770
              },
              "vertices": [
                {
                  "x": 772,
                  "y": 192
                },
                {
                  "x": 551,
                  "y": 230
                },
                {
                  "x": 338,
                  "y": 514
                },
                {
                  "x": 565,
                  "y": 750
                }
              ],
              "id": "f047c903-b39d-4b07-925a-76a56c6cf79e",
              "z": 39,
              "attrs": {}
            }
          ]
        },
        "size": {
          "height": 1001.25,
          "width": 4807.837890625
        }
      }
    ],
    "reviewer": "Dave"
  }
}